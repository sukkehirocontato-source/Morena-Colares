<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Noite & Girassóis — Colares</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap');

  :root{
    --text: #f5ecd8;
    --card-bg: rgba(3,10,30,0.28);
    --backup-bg: linear-gradient(180deg,#02102a,#042446);
  }

  html,body{
    height:100%;
    margin:0;
    font-family:'Playfair Display', serif;
    color:var(--text);
    display:flex;
    align-items:center;
    justify-content:center;
    padding:20px;
    box-sizing:border-box;
    background: var(--backup-bg);
    background-size:cover;
    background-position:center;
    transition: background 300ms ease;
  }

  /* girassóis decorativos (preenchidos por JS) */
  .sunflower {
    position:fixed;
    width:96px;
    height:96px;
    background-size:cover;
    background-position:center;
    pointer-events:none;
    opacity:0.96;
    filter:drop-shadow(0 6px 12px rgba(0,0,0,0.45));
    animation: float 9s ease-in-out infinite;
    z-index:1;
  }
  .s1{ left:6%; top:12%; transform:rotate(-10deg); animation-duration:9s; }
  .s2{ right:6%; top:18%; transform:rotate(12deg); width:120px;height:120px; animation-duration:11s; }
  .s3{ left:5%; bottom:14%; transform:rotate(6deg); width:82px;height:82px; animation-duration:12s; }
  .s4{ right:10%; bottom:10%; transform:rotate(-18deg); width:98px;height:98px; animation-duration:10s; }

  @keyframes float{
    0% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-12px) rotate(6deg); }
    100% { transform: translateY(0) rotate(0deg); }
  }

  .card {
    position:relative;
    z-index:2;
    background: var(--card-bg);
    backdrop-filter: blur(3px);
    padding:28px;
    border-radius:14px;
    max-width:780px;
    width:100%;
    box-shadow: 0 12px 36px rgba(0,0,0,0.5);
    text-align:center;
  }

  h1{
    margin:0 0 8px 0;
    font-size:2.0rem;
    text-shadow: 2px 4px 10px rgba(0,0,0,0.55);
  }

  .poema{
    margin:12px 0 16px;
    font-size:1.04rem;
    line-height:1.6;
    white-space:pre-line;
    text-shadow: 1px 2px 6px rgba(0,0,0,0.5);
  }

  .meta{
    font-size:0.95rem;
    opacity:0.95;
    margin-bottom:14px;
  }

  .player{
    display:flex;
    gap:12px;
    align-items:center;
    justify-content:center;
    flex-wrap:wrap;
  }

  .btn-play{
    background: linear-gradient(180deg,#ffd95a,#ffb84d);
    border:none;
    padding:12px 18px;
    border-radius:999px;
    font-weight:700;
    cursor:pointer;
    box-shadow: 0 6px 18px rgba(0,0,0,0.32);
  }

  .btn-play:active{ transform: translateY(1px); }

  .audio-controls {
    display:flex;
    align-items:center;
    gap:8px;
    flex-wrap:wrap;
  }

  .hint {
    display:block;
    margin-top:8px;
    font-size:0.85rem;
    opacity:0.9;
  }

  @media (max-width:600px){
    .card{ padding:18px; }
    h1{ font-size:1.5rem; }
    .poema{ font-size:0.98rem; }
    .sunflower{ display:none; }
  }
</style>
</head>
<body>
  <!-- girassóis (decor) -->
  <div class="sunflower s1" aria-hidden="true"></div>
  <div class="sunflower s2" aria-hidden="true"></div>
  <div class="sunflower s3" aria-hidden="true"></div>
  <div class="sunflower s4" aria-hidden="true"></div>

  <main class="card" role="main" aria-labelledby="title">
    <h1 id="title">Noite &amp; Girassóis — Uma pequena declaração</h1>

    <div class="poema" id="poema">
Na curva azul do céu girado por Van Gogh,  
minhas memórias acendem como estrelas.  
A noite veste-se de tinta e respira —  
cada luz é um pó de caminho, cada fio, um verso.  

Girassóis olham a lua, certeiros, silenciosos;  
guardam no centro o sol que já passou.  
Que essa tela seja ponte: do teu olhar ao meu,  
onde a calma da noite encontra o calor da flor.
    </div>

    <div class="meta">Manaus, 11 de agosto de 2025 — <strong>Colares</strong></div>

    <div class="player" aria-label="Player de áudio">
      <button class="btn-play" id="playBtn" aria-pressed="false">▶️ Ouvir declaração</button>

      <div class="audio-controls">
        <!-- audio com múltiplas fontes (mp3 primeiro) e controles nativos visíveis -->
        <audio id="audioPlayer" preload="auto" controls>
          <source src="assets/morena.mp3" type="audio/mpeg">
          <source src="assets/morena.wav" type="audio/wav">
          Seu navegador não suporta reprodução de áudio.
        </audio>

        <!-- link direto para testar o arquivo -->
        <a id="audioLink" href="assets/morena.mp3" target="_blank" rel="noopener">Abrir áudio direto</a>
      </div>

      <span class="hint">Se não ouvir nada: verifique volume do dispositivo e clique em "Abrir áudio direto".</span>
    </div>
  </main>

<script>
/* ---------- Helpers para localizar imagens com extensões comuns ---------- */
function candidatesFor(base){
  const exts = ['.jpg','.jpeg','.png','.webp','.gif'];
  return exts.map(ext => base + ext);
}

function firstAvailable(candidates){
  return new Promise(resolve => {
    if(!candidates || candidates.length === 0) return resolve(null);
    let remaining = candidates.length;
    let found = false;
    candidates.forEach(url => {
      const img = new Image();
      img.onload = () => { if(!found){ found = true; resolve(url);} };
      img.onerror = () => { remaining--; if(remaining === 0 && !found) resolve(null); };
      img.src = url;
    });
  });
}

/* ---------- Carrega fundo e girassóis a partir de assets/ ---------- */
(async function loadAssets(){
  // fundo (assets/starry.*)
  const bgCandidates = candidatesFor('assets/starry');
  const bgUrl = await firstAvailable(bgCandidates);
  if(bgUrl){
    document.body.style.backgroundImage = `url("${bgUrl}")`;
    document.body.style.backgroundSize = 'cover';
    document.body.style.backgroundPosition = 'center';
    document.body.style.backgroundAttachment = 'fixed';
  } else {
    console.warn('Imagem de fundo não encontrada em assets/starry.* — usando gradiente fallback.');
  }

  // girassóis
  const s1 = await firstAvailable(candidatesFor('assets/sun1'));
  const s2 = await firstAvailable(candidatesFor('assets/sun2'));

  const elS1 = document.querySelector('.s1');
  const elS2 = document.querySelector('.s2');
  const elS3 = document.querySelector('.s3');
  const elS4 = document.querySelector('.s4');

  if(s1) elS1.style.backgroundImage = `url("${s1}")`;
  if(s2) elS2.style.backgroundImage = `url("${s2}")`;

  if(!s1 && s2){
    elS1.style.backgroundImage = `url("${s2}")`;
    elS3.style.backgroundImage = `url("${s2}")`;
    elS4.style.backgroundImage = `url("${s2}")`;
  } else if(s1 && !s2){
    elS2.style.backgroundImage = `url("${s1}")`;
    elS3.style.backgroundImage = `url("${s1}")`;
    elS4.style.backgroundImage = `url("${s1}")`;
  } else if(s1 && s2){
    elS3.style.backgroundImage = `url("${s1}")`;
    elS4.style.backgroundImage = `url("${s2}")`;
  } else {
    [elS1,elS2,elS3,elS4].forEach(el => { if(el) el.style.display = 'none'; });
    console.warn('Imagens de girassol não encontradas em assets/sun1.* ou assets/sun2.* — decor invisível.');
  }
})();

/* ---------- Player (async + proteção contra AbortError) ---------- */
const audio = document.getElementById('audioPlayer');
const btn = document.getElementById('playBtn');

function updateBtn(){
  if(!audio || audio.paused){
    btn.textContent = '▶️ Ouvir declaração';
    btn.setAttribute('aria-pressed','false');
  } else {
    btn.textContent = '⏸️ Pausar';
    btn.setAttribute('aria-pressed','true');
  }
}

btn.addEventListener('click', async () => {
  if(!audio) return alert('Áudio não encontrado.');
  if (btn.disabled) return;
  btn.disabled = true;

  try {
    // garante que o elemento carregue as fontes definidas
    audio.load();
    if (audio.paused) {
      await audio.play();
    } else {
      audio.pause();
    }
  } catch (err) {
    console.error('Erro ao reproduzir:', err);
    if (audio && audio.error) console.error('AudioElement error:', audio.error);
    alert('Não foi possível reproduzir o áudio. Tente abrir o arquivo direto clicando em "Abrir áudio direto".');
  } finally {
    updateBtn();
    setTimeout(() => { btn.disabled = false; }, 150);
  }
});

/* listeners para atualizar estado do botão */
if (audio) {
  audio.addEventListener('play', updateBtn);
  audio.addEventListener('pause', updateBtn);
  audio.addEventListener('ended', updateBtn);
  audio.addEventListener('error', () => {
    console.error('Erro do elemento audio:', audio.error);
    // mostre aviso curto ao usuário
    // alert('Erro ao carregar o arquivo de áudio (ver console).');
  });
}

/* Log útil: imprime quando puder tocar */
if (audio) {
  audio.addEventListener('canplay', () => console.log('Audio: canplay'));
  audio.addEventListener('canplaythrough', () => console.log('Audio: canplaythrough'));
}
</script>
</body>
</html>
